#!/bin/bash

# Script to build the HTML5 output for "Modding never changes", vol. 2.

ASCIIDOCTOR_STYLESHEET_FACTORY_DIR=~/Dropbox/Documents/Articles/asciidoctor-stylesheet-factory-master
SASS_SOURCE_FILES_DIR=src/main/docs/sass
STYLES_RESOURCES_DIR=src/main/resources/styles
OUTPUT_DIR=build

# Step 1: Removes the test folder, if it exists.
if [ -d "build/test" ]; then
	rm -frv build/test
fi

# Step 2: Copies the SASS source files to the AsciiDoctor Style Sheet Factory folder.
cp $SASS_SOURCE_FILES_DIR/_Modding-never-changes-vol-2.scss $ASCIIDOCTOR_STYLESHEET_FACTORY_DIR/sass/settings
cp $SASS_SOURCE_FILES_DIR/Modding-never-changes-vol-2.scss $ASCIIDOCTOR_STYLESHEET_FACTORY_DIR/sass

# Step 3: Compiles the SASS sources into the CSS output.
pushd $ASCIIDOCTOR_STYLESHEET_FACTORY_DIR
compass compile

# Step 4: Copies back the CSS generated file into the resources folder.
popd
cp $ASCIIDOCTOR_STYLESHEET_FACTORY_DIR/stylesheets/Modding-never-changes-vol-2.css $STYLES_RESOURCES_DIR

# Step 5: Invoke Maven to build the HTML5 output.
mvn

# Step 6 (optional): Unzip the buildfile to test the results.
if [ "$1" == "/t" ]; then
	unzip build/*.zip -d build/test
fi